var departments = new Array();
<% @staff_departments.each do |d| %>
  departments.push(new Array(<%= d.category_id%>, "<%=h d.name%>", <%= d.id%>));
<% end %>

function categorySelected(){
  category_id = $('#cat').getvalue();
  options = $('#dept').options;
  options.length = 1;
  departments.each(function(department) {
    if(department[0] == category_id){
      options[options.length] = new Option[department[1], department[2]]
    }
  });
  if (options.length == 1) {
    $('dept_field').hide();
    else {
      $('dept_field').show();
    }
  }
}

document.observe('dom:loaded', function() {
  $('dept_field').hide();
  $('cat').observe('change', categorySelected);
});
